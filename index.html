<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Grupos WhatsApp</title>
<meta property="og:title" content="Grifin√≥ria ?">
<meta property="og:description" content="Convite para conversar em grupo">
<meta property="og:image" content="https://files.catbox.moe/ls07y5.jpg">
<meta property="og:url" content="https://saniofc.github.io/griffinoria/">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary_large_image">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Arial,sans-serif;color:#fff;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding-top:120px;background:#000}
#video-bg{position:fixed;inset:0;width:100%;height:100%;object-fit:cover;z-index:-1;filter:brightness(0.4)}
header{position:fixed;top:0;left:0;width:100%;padding:12px 10px;background:rgba(0,0,0,0.6);text-align:center;z-index:1000}
header h1{font-size:28px;text-shadow:2px 2px 5px #000}
header p{margin-top:4px;text-shadow:1px 1px 3px #000}
#contador{margin-top:4px;color:#ffd700;text-shadow:1px 1px 2px #000;font-size:15px}
#categorias{margin-top:8px;display:flex;justify-content:center;gap:6px;flex-wrap:wrap}
.cat-btn{background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:20px;color:#fff;font-size:13px;padding:5px 11px;cursor:pointer;transition:all .2s}
.cat-btn:hover{background:rgba(255,255,255,0.25)}
.cat-btn.active{background:#b78cff;border-color:#b78cff}
.menu-icon{position:fixed;top:20px;right:20px;font-size:28px;z-index:1100;background:rgba(0,0,0,0.6);padding:6px 12px;border-radius:10px;cursor:pointer}
.menu{position:fixed;top:0;right:-300px;width:250px;height:100%;background:rgba(0,0,0,0.9);padding:30px 20px;transition:right .3s;z-index:1200}
.menu.open{right:0}
.menu .close-btn{position:absolute;top:15px;right:20px;background:none;border:none;color:#fff;font-size:26px;cursor:pointer}
.menu h2{margin-top:50px;color:#b78cff;border-bottom:1px solid #b78cff;padding-bottom:5px;text-align:left}
.menu a{display:block;text-decoration:none;color:#fff;background:rgba(183,140,255,0.12);padding:12px;border-radius:10px;margin-top:15px;text-align:left;font-size:18px}
.menu a:hover{background:rgba(183,140,255,0.25)}
#lista-grupos{width:100%;max-width:420px;padding:30px 20px 60px;display:flex;flex-direction:column;align-items:center;gap:22px}
.grupo{width:100%;max-width:380px;display:flex;align-items:center;gap:14px;background:rgba(0,0,0,0.55);padding:14px 20px;border-radius:40px;text-decoration:none;color:#fff;position:relative;transition:transform .18s,background .18s;border:1px solid rgba(255,255,255,0.1)}
.grupo:hover{transform:scale(1.02);background:rgba(0,0,0,0.65)}
.grupo img.foto{width:60px;height:60px;border-radius:50%;object-fit:cover;border:2px solid #fff}
.grupo .info{display:flex;flex-direction:column;align-items:flex-start;justify-content:center;text-align:left}
.grupo span.nome{font-size:19px;font-weight:bold;line-height:1.2}
.grupo .categoria{font-size:14px;color:#ffd700;margin-top:4px}
.grupo.vip{box-shadow:0 0 18px 6px rgba(255,215,0,0.12),0 0 28px rgba(255,215,0,0.08) inset;border:1px solid rgba(255,215,0,0.35)}
.grupo.vip::before{content:"‚≠ê";position:absolute;left:-14px;top:50%;transform:translateY(-50%);font-size:24px;color:#ffd700;text-shadow:0 0 8px #ffda00,0 0 12px #ffb700;animation:shine 1.4s infinite alternate}
@keyframes shine{from{opacity:0.7;transform:translateY(-50%) scale(1);}to{opacity:1;transform:translateY(-50%) scale(1.2)}}
.botao{background:rgba(0,0,0,0.7);color:#fff;border:2px solid #fff;border-radius:30px;padding:12px 28px;margin-top:20px;text-decoration:none;font-size:18px;transition:transform .18s,box-shadow .18s;display:inline-block}
.botao:hover{transform:scale(1.04)}
footer{position:fixed;bottom:0;left:0;width:100%;background:rgba(0,0,0,0.8);color:#ccc;text-align:center;padding:14px 10px;font-size:14px;line-height:1.6;z-index:2000}
footer a{color:#b78cff;text-decoration:none}
/* Modal */
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:none;justify-content:center;align-items:center;z-index:5000}
.modal-content{background:#111;padding:20px;border-radius:20px;max-width:400px;width:90%;text-align:center;color:#fff;position:relative}
.modal-content h3{margin-bottom:15px}
.modal-content input, .modal-content select{width:90%;margin:5px 0;padding:8px;border-radius:10px;border:none}
.modal-content button{padding:10px 20px;margin-top:10px;border:none;border-radius:15px;background:#b78cff;color:#fff;cursor:pointer;transition:0.2s}
.modal-content button:hover{background:#a56be0}
.modal .close-modal{position:absolute;top:10px;right:15px;font-size:22px;cursor:pointer}
</style>
</head>
<body>
<video id="video-bg" autoplay muted loop playsinline>
  <source src="https://files.catbox.moe/dymzif.mp4" type="video/mp4">
</video>

<header>
  <h1>Grupos WhatsApp</h1>
  <p></p>
  <p id="contador">Visitas: 0</p>
  <div id="categorias">
    <button class="cat-btn active" data-cat="Todos">Todos</button>
    <button class="cat-btn" data-cat="amizade">Amizade</button>
    <button class="cat-btn" data-cat="zoeira">Zoeira</button>
    <button class="cat-btn" data-cat="namoro">Namoro</button>
  </div>
</header>

<div class="menu-icon" id="menuBtn">üìù</div>
<div class="menu" id="sideMenu">
  <button class="close-btn" id="closeBtn">‚ùå</button>
  <h2>Informa??es</h2>
  <a href="https://br.shp.ee/1r878lx?smtt=0.0.9" target="_blank">üõçÔ∏èLoja da Miih</a>
  <a href="https://wa.me//5521977231625" target="_blank">ü§ñAlugar bot</a>
  <a href="#" id="meusGrupos">üìãMeus Grupos</a>
  <a href="#" id="enviarGrupo">üì®Enviar Meu Grupo</a>
  <a href="https://wa.me//5521977231625" target="_blank">üíéComprar bot</a>
</div>

<div id="lista-grupos"></div>
<a class="botao" href="https://linkfly.to/grifinoria" target="_blank">Outros Grupos</a>

<footer>
  Blog ¬∑ Termos de Uso ¬∑ Pol√≠tica de Privacidade ¬∑ FAQ<br>
  ? COPYRIGHT 2025 - <a href="https://saniofc.github.io/griffinoria/" target="_blank">saniofc.github.io/griffinoria/</a>
</footer>

<!-- ==== SCRIPT FIREBASE E L?GICA ==== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getDatabase, ref, onValue, runTransaction, set, remove } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDsrYjO2yVTemKqwmJRzNjh5sfaMalPqhE",
  authDomain: "cliques-4a2c1.firebaseapp.com",
  databaseURL: "https://cliques-4a2c1-default-rtdb.firebaseio.com",
  projectId: "cliques-4a2c1",
  storageBucket: "cliques-4a2c1.firebasestorage.app",
  messagingSenderId: "903875153255",
  appId: "1:903875153255:web:ff3cf25e059b10d665b3c2",
  measurementId: "G-BQHZ7FWRJD"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// MENU
const menu = document.getElementById('sideMenu');
document.getElementById('menuBtn').addEventListener('click',()=>menu.classList.add('open'));
document.getElementById('closeBtn').addEventListener('click',()=>menu.classList.remove('open'));

let todosGrupos = [];

// ================== CARREGAR GRUPOS ================== //
async function carregarGrupos() {
  let jsonGrupos = [];
  try {
    const res = await fetch('grupos.json');
    jsonGrupos = await res.json();
  } catch (e) {
    console.warn('?? Nenhum grupos.json encontrado ou erro ao carregar:', e);
  }

  const gruposRef = ref(db, 'grupos');
  onValue(gruposRef, snap => {
    const dadosFirebase = snap.val() ? Object.values(snap.val()) : [];
    const enviadosLocais = JSON.parse(localStorage.getItem('gruposEnviados') || '[]');

    // Combinar todos removendo duplicatas (mesmo nome = mesmo grupo)
    const mapa = new Map();

    [...jsonGrupos, ...dadosFirebase, ...enviadosLocais].forEach(g => {
      if (g?.nome) mapa.set(g.nome.toLowerCase(), g);
    });

    todosGrupos = Array.from(mapa.values());
    renderizarGrupos(todosGrupos);
  });
}

// ================== RENDERIZAR GRUPOS ================== //
function renderizarGrupos(lista) {
  const container = document.getElementById('lista-grupos');
  container.innerHTML = '';

  if (lista.length === 0) {
    container.innerHTML = '<p style="color:#ccc;">Nenhum grupo encontrado.</p>';
    return;
  }

  const usuario = localStorage.getItem('usuarioID');

  lista.forEach(g => {
    const btn = document.createElement('a');
    btn.className = 'grupo' + (g.vip ? ' vip' : '');
    btn.href = g.link;
    btn.target = '_blank';
    btn.innerHTML = `
      <img class="foto" src="${g.foto}" alt="foto do grupo">
      <div class="info">
        <span class="nome">${g.nome}</span>
        <div class="categoria">${g.categoria || ''}</div>
        <div class="cliques" style="position:absolute;top:6px;right:14px;font-size:12px;color:#ffd700;">0</div>
      </div>
    `;

    const cliqueRef = ref(db, 'cliques/' + g.nome);
    onValue(cliqueRef, snap => {
      btn.querySelector('.cliques').textContent = `Cliques: ${snap.val() || 0}`;
    });

    btn.addEventListener('click', e => {
      e.preventDefault();
      runTransaction(cliqueRef, c => (c || 0) + 1).then(() => window.open(g.link, '_blank'));
      atualizarVisitas();
    });

    // Editar/Excluir
    if (g.dono === usuario) {
      const box = document.createElement('div');
      box.style.position = 'absolute';
      box.style.left = '10px';
      box.style.top = '10px';
      box.style.display = 'flex';
      box.style.gap = '6px';

      const edit = document.createElement('button');
      edit.textContent = '??';
      edit.style.cursor = 'pointer';
      edit.onclick = () => abrirEdicao(g);

      const del = document.createElement('button');
      del.textContent = '??';
      del.style.cursor = 'pointer';
      del.onclick = () => excluirGrupo(g);

      box.appendChild(edit);
      box.appendChild(del);
      btn.appendChild(box);
    }

    container.appendChild(btn);
  });
}

// ================== EDI??O E EXCLUS?O ================== //
function abrirEdicao(grupo){
  modal.style.display = 'flex';
  document.getElementById('grupoNome').value = grupo.nome;
  document.getElementById('grupoLink').value = grupo.link;
  document.getElementById('grupoFoto').value = grupo.foto;
  document.getElementById('grupoCategoria').value = grupo.categoria;
  document.getElementById('salvarGrupo').onclick = () => salvarEdicao(grupo);
}

function salvarEdicao(grupo){
  grupo.nome = document.getElementById('grupoNome').value.trim();
  grupo.link = document.getElementById('grupoLink').value.trim();
  grupo.foto = document.getElementById('grupoFoto').value.trim() || 'https://files.catbox.moe/ls07y5.jpg';
  grupo.categoria = document.getElementById('grupoCategoria').value;

  const refGrupo = ref(db, 'grupos/' + grupo.nome);
  set(refGrupo, grupo);

  let enviados = JSON.parse(localStorage.getItem('gruposEnviados') || '[]');
  enviados = enviados.map(g => g.nome === grupo.nome ? grupo : g);
  localStorage.setItem('gruposEnviados', JSON.stringify(enviados));

  modal.style.display = 'none';
  renderizarGrupos(todosGrupos);
}

function excluirGrupo(grupo){
  if (!confirm('Deseja realmente excluir este grupo?')) return;
  remove(ref(db, 'grupos/' + grupo.nome));
  todosGrupos = todosGrupos.filter(g => g.nome !== grupo.nome);

  let enviados = JSON.parse(localStorage.getItem('gruposEnviados') || '[]');
  enviados = enviados.filter(g => g.nome !== grupo.nome);
  localStorage.setItem('gruposEnviados', JSON.stringify(enviados));

  renderizarGrupos(todosGrupos);
}

// ================== VISITAS ================== //
const contador = document.getElementById('contador');
const visitasRef = ref(db, 'visitas');
onValue(visitasRef, snap => {
  contador.textContent = `Visitas: ${snap.val() || 0}`;
});
function atualizarVisitas() {
  runTransaction(visitasRef, v => (v || 0) + 1);
}
atualizarVisitas();

// ================== FILTRO ================== //
document.querySelectorAll('.cat-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const cat = btn.dataset.cat.toLowerCase();
    if (cat === 'todos') renderizarGrupos(todosGrupos);
    else renderizarGrupos(todosGrupos.filter(g => g.categoria?.toLowerCase() === cat));
  });
});

// ================== MODAL ================== //
const enviarBtn = document.getElementById('enviarGrupo');
const meusBtn = document.getElementById('meusGrupos');

const modal = document.createElement('div');
modal.className = 'modal';
modal.innerHTML = `
  <div class="modal-content">
    <span class="close-modal">?</span>
    <h3>Enviar Meu Grupo</h3>
    <input type="text" id="grupoNome" placeholder="Nome do grupo">
    <input type="text" id="grupoLink" placeholder="Link do grupo (https://chat.whatsapp.com/...)">
    <input type="text" id="grupoFoto" placeholder="URL da foto (opcional)">
    <select id="grupoCategoria">
      <option value="">Selecione a categoria</option>
      <option value="Amizade">Amizade</option>
      <option value="Zoeira">Zoeira</option>
      <option value="Namoro">Namoro</option>
    </select>
    <input type="text" id="grupoVipCodigo" placeholder="C√≥digo VIP (opcional)">
    <button id="salvarGrupo">Salvar Grupo</button>
  </div>`;
document.body.appendChild(modal);

modal.querySelector('.close-modal').onclick = () => modal.style.display = 'none';
enviarBtn.onclick = () => {
  modal.style.display = 'flex';
  // limpa campos ao abrir
  document.getElementById('grupoNome').value = '';
  document.getElementById('grupoLink').value = '';
  document.getElementById('grupoFoto').value = '';
  document.getElementById('grupoCategoria').value = '';
  document.getElementById('grupoVipCodigo').value = '';
};

// ================== SALVAR NOVO GRUPO ================== //
document.getElementById('salvarGrupo').onclick = async () => {
  const nome = document.getElementById('grupoNome').value.trim();
  const link = document.getElementById('grupoLink').value.trim();
  const foto = document.getElementById('grupoFoto').value.trim() || 'https://files.catbox.moe/ls07y5.jpg';
  const categoria = document.getElementById('grupoCategoria').value;
  const vipCodigo = document.getElementById('grupoVipCodigo').value.trim();

  // Valida??o
  if (!nome || !link.startsWith('https://chat.whatsapp.com/')) {
    alert('Preencha corretamente o nome e o link do grupo!');
    return;
  }

  // C√≥digo VIP
  const isVip = vipCodigo === "MIHVIP2025"; // ? altere aqui o c√≥digo VIP se quiser

  const usuario = localStorage.getItem('usuarioID') || crypto.randomUUID();
  localStorage.setItem('usuarioID', usuario);

  const novoGrupo = { nome, link, foto, categoria, dono: usuario, vip: isVip };

  // Evitar duplica??o
  const jaExiste = todosGrupos.some(g => g.nome.toLowerCase() === nome.toLowerCase());
  if (jaExiste) {
    alert('J√° existe um grupo com esse nome. Escolha outro.');
    return;
  }

  // Adicionar ao Firebase
  await set(ref(db, 'grupos/' + nome), novoGrupo);

  // Atualizar localmente
  todosGrupos.push(novoGrupo);
  let enviados = JSON.parse(localStorage.getItem('gruposEnviados') || '[]');
  enviados.push(novoGrupo);
  localStorage.setItem('gruposEnviados', JSON.stringify(enviados));

  renderizarGrupos(todosGrupos);
  modal.style.display = 'none';
};

// ================== MEUS GRUPOS ================== //
meusBtn.onclick = () => {
  const usuario = localStorage.getItem('usuarioID');
  if (!usuario) return alert('Voc√™ ainda n?o enviou nenhum grupo.');
  const meus = todosGrupos.filter(g => g.dono === usuario);
  if (meus.length === 0) alert('Voc√™ ainda n?o enviou nenhum grupo.');
  else renderizarGrupos(meus);
};

// ================== INICIAR ================== //
carregarGrupos();
</script>
</body>
</html>
